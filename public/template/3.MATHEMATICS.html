<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="MATHEMATICS
3.数学知识
3.1数论
3.1.1扩展欧几里德算法
首先我们有欧几里德算法：
\[gcd(a, b) = gcd(a\  mod\ b, b)\]
扩展欧几里德算法解决了这样的问题：
\[ ax + by = gcd(a,b)\]
我们先考察一种特殊的情况：
当\(b=0\)时，我们直接可以有解： \[
\begin{eqnarray}
\left\{
\begin{ar">
<meta property="og:type" content="website">
<meta property="og:title" content="Konjac's Blog">
<meta property="og:url" content="http://mrmorning.github.io/template/3.MATHEMATICS.html">
<meta property="og:site_name" content="Konjac's Blog">
<meta property="og:description" content="MATHEMATICS
3.数学知识
3.1数论
3.1.1扩展欧几里德算法
首先我们有欧几里德算法：
\[gcd(a, b) = gcd(a\  mod\ b, b)\]
扩展欧几里德算法解决了这样的问题：
\[ ax + by = gcd(a,b)\]
我们先考察一种特殊的情况：
当\(b=0\)时，我们直接可以有解： \[
\begin{eqnarray}
\left\{
\begin{ar">
<meta property="og:updated_time" content="2017-03-17T22:37:22.911Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Konjac's Blog">
<meta name="twitter:description" content="MATHEMATICS
3.数学知识
3.1数论
3.1.1扩展欧几里德算法
首先我们有欧几里德算法：
\[gcd(a, b) = gcd(a\  mod\ b, b)\]
扩展欧几里德算法解决了这样的问题：
\[ ax + by = gcd(a,b)\]
我们先考察一种特殊的情况：
当\(b=0\)时，我们直接可以有解： \[
\begin{eqnarray}
\left\{
\begin{ar">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://mrmorning.github.io/template/3.MATHEMATICS.html"/>





  <title>
  

  
     | Konjac's Blog
  
</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Konjac's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">+1s</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tasks">
          <a href="/tasks" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tasks"></i> <br />
            
            任务
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-template">
          <a href="/template" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bomb"></i> <br />
            
            模板
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
  <header class="post-header">

	<h1 class="post-title" itemprop="name headline"></h1>



</header>

    
    
      <h1 id="mathematics">MATHEMATICS</h1>
<h2 id="数学知识">3.数学知识</h2>
<h3 id="数论">3.1数论</h3>
<h4 id="扩展欧几里德算法">3.1.1扩展欧几里德算法</h4>
<p>首先我们有欧几里德算法：</p>
<p><span class="math display">\[gcd(a, b) = gcd(a\  mod\ b, b)\]</span></p>
<p>扩展欧几里德算法解决了这样的问题：</p>
<p><span class="math display">\[ ax + by = gcd(a,b)\]</span></p>
<p>我们先考察一种特殊的情况：</p>
<p>当<span class="math inline">\(b=0\)</span>时，我们直接可以有解： <span class="math display">\[
\begin{eqnarray}
\left\{
\begin{array}{lll}
x = 1 \\
y = 0
\end{array}
\right.
\end{eqnarray}
\]</span> 一般地，我们令<span class="math inline">\(c = a\ mod \ b\)</span>，递归地解下面的方程：</p>
<p><span class="math display">\[bx^{&#39;}+cy^{&#39;}=gcd(b,c)\]</span></p>
<p>根据欧几里德算法，有</p>
<p><span class="math display">\[bx^{&#39;}+cy^{&#39;}=gcd(a,b)\]</span></p>
<p>根据<span class="math inline">\(mod\)</span>的定义我们可以有</p>
<p><span class="math display">\[c = a - b\lfloor\frac{a}{b}\rfloor\]</span></p>
<p>带入原式</p>
<p><span class="math display">\[bx^{&#39;}+(a - b\lfloor\frac{a}{b}\rfloor)y^{&#39;}=gcd(a,b)\]</span></p>
<p>为了体现与<span class="math inline">\(a,b\)</span>的关系</p>
<p><span class="math display">\[ay^{&#39;}+b(x^{&#39;}-\lfloor\frac{a}{b}\rfloor y^{&#39;})=gcd(a,b)\]</span></p>
<p>所以这样就完成了回溯。</p>
<p>这个算法的思想体现在了下面的程序里。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;d, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span>(!b) &#123;d = a; x = <span class="number">1</span>; y = <span class="number">0</span>; &#125;</div><div class="line">  <span class="keyword">else</span> &#123; gcd(b, a%b, d, y, x); y -= x * (a/b); &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="线性筛与积性函数">3.1.2线性筛与积性函数</h4>
<h5 id="线性筛素数">3.1.2.1线性筛素数</h5>
<p>首先给出线性筛素数的程序。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_su</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">  tot = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</div><div class="line">    <span class="keyword">if</span>(!check[i]) prime[tot++] = i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tot; j++) &#123;</div><div class="line">      <span class="keyword">if</span>(i * prime[j] &gt; n) <span class="keyword">break</span>;</div><div class="line">      check[i * prime[j]] = <span class="literal">true</span>;</div><div class="line">      <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以证明的是，每个合数都仅仅会被他的最小质因数筛去，这段代码的时间复杂度是<span class="math inline">\(\Theta (n)\)</span>的，也就是所谓线性筛。</p>
<blockquote>
<p>证明：设合数<span class="math inline">\(n\)</span>最小的质因数为<span class="math inline">\(p\)</span>，它的另一个大于<span class="math inline">\(p\)</span>的质因数为<span class="math inline">\(p^{&#39;}\)</span>，另<span class="math inline">\(n = pm=p^{&#39;}m^{&#39;}\)</span>。 观察上面的程序片段，可以发现<span class="math inline">\(j\)</span>循环到质因数<span class="math inline">\(p\)</span>时合数n第一次被标记（若循环到<span class="math inline">\(p\)</span>之前已经跳出循环，说明<span class="math inline">\(n\)</span>有更小的质因数），若也被<span class="math inline">\(p^{&#39;}\)</span>标记，则是在这之前（因为<span class="math inline">\(m^{&#39;}&lt;m\)</span>），考虑<span class="math inline">\(i\)</span>循环到<span class="math inline">\(m^{&#39;}\)</span>，注意到<span class="math inline">\(n=pm=p^{&#39;}m^{&#39;}\)</span>且<span class="math inline">\(p,p^{&#39;}\)</span>为不同的质数，因此<span class="math inline">\(p|m^{&#39;}\)</span>，所以当j循环到质数p后结束，不会循环到<span class="math inline">\(p^{&#39;}\)</span>，这就说明<span class="math inline">\(n\)</span>不会被<span class="math inline">\(p^{&#39;}\)</span>筛去。</p>
</blockquote>
<h5 id="积性函数">3.1.2.2积性函数</h5>
<ul>
<li>考虑一个定义域为<span class="math inline">\(\mathbb{N}^{+}\)</span>的函数<span class="math inline">\(f\)</span>（数论函数），对于任意两个<strong>互质</strong>的正整数<span class="math inline">\(a,b\)</span>，均满足</li>
</ul>
<p><span class="math display">\[f(ab) = f(a)f(b)\]</span>，则函数<em>f</em>被称为积性函数。</p>
<ul>
<li>如果对于任意两个正整数<span class="math inline">\(a,b\)</span>，都有<span class="math inline">\(f(ab)=f(a)f(b)\)</span>，那么就被称作完全积性函数。</li>
</ul>
<p>容易看出，对于任意积性函数，<span class="math inline">\(f(1)=1\)</span>。</p>
<ul>
<li>考虑一个大于1的正整数<span class="math inline">\(N\)</span>，设<span class="math inline">\(N = \prod p_{i}^{a_i}\)</span>，那么</li>
</ul>
<p><span class="math display">\[f(N)=f(\prod p_i^{a_i})=\prod f(p_i^{a_i})\]</span>，如果<span class="math inline">\(f\)</span>还满足完全积性，那么</p>
<p><span class="math display">\[f(N)=\prod f(p_i)^{a_i}\]</span></p>
<ul>
<li>如果<span class="math inline">\(f\)</span>是一个任意的函数，它使得和式<span class="math inline">\(g(m) = \sum_{d|m}f(d)\)</span>为积性函数，那么<span class="math inline">\(f\)</span>也一定是积性函数。</li>
<li>积性函数的Dirichlet前缀和也是积性函数。这个定理是上面定理的反命题。</li>
<li>两个积性函数的Dirichlet卷积也是积性函数。</li>
</ul>
<h5 id="欧拉函数varphi">3.1.2.3欧拉函数<span class="math inline">\(\varphi\)</span></h5>
<ul>
<li><span class="math inline">\(\varphi(n)\)</span>表示<span class="math inline">\(1..n\)</span>中与<span class="math inline">\(n\)</span>互质的整数个数。</li>
<li>我们有欧拉定理：</li>
</ul>
<p><span class="math display">\[n^{\varphi(m)}\equiv 1 \pmod m\ \ \ \ n\perp m\]</span></p>
<p>可以使用这个定理计算逆元。</p>
<ul>
<li>如果<span class="math inline">\(m\)</span>是一个素数幂，则容易计算<span class="math inline">\(\varphi(m)\)</span>，因为有$n p^{k} p n $ 。在<span class="math inline">\(\{0,1,...,p^k-1\}\)</span>中的<span class="math inline">\(p\)</span>的倍数是<span class="math inline">\(\{0, p, 2p, ..., p^k-p\}\)</span>，从而有<span class="math inline">\(p^{k-1}\)</span>个，剩下的计入<span class="math inline">\(\varphi(p^k)\)</span></li>
</ul>
<p><span class="math display">\[\varphi(p^k) = p^k-p^{k-1}=(p-1)p^{k-1}\]</span></p>
<ul>
<li>由上面的推导我们不难得出欧拉函数一般的表示：</li>
</ul>
<p><span class="math display">\[\varphi(m) = \prod_{p|m}(p^{m_p}-p^{m_p-1}) = m \prod_{p|m}(1-\frac{1}{p})=\prod(p-1)p^{m_p-1}\]</span></p>
<ul>
<li>运用Mobius反演，不难得出<span class="math inline">\(\sum_{d|n}\varphi(d) = n\)</span>。</li>
<li>当<span class="math inline">\(n&gt;1\)</span>时，<span class="math inline">\(1..n\)</span>中与<span class="math inline">\(n\)</span>互质的整数和为<span class="math inline">\(\frac{n\varphi(n)}{2}\)</span></li>
<li>降幂大法<span class="math display">\[A^B\ mod\ C=A^{B\ mod\ \varphi(C)+\varphi(C)}\ mod\ C\]</span></li>
</ul>
<h5 id="线性筛法求解积性函数">3.1.2.4线性筛法求解积性函数</h5>
<ul>
<li>积性函数的关键是如何求<span class="math inline">\(f(p^k)\)</span>。</li>
<li>观察线性筛法中的步骤，筛掉n的同时还得到了他的最小的质因数<span class="math inline">\(p\)</span>，我们希望能够知道<span class="math inline">\(p\)</span>在<span class="math inline">\(n\)</span>中的次数，这样就能够利用<span class="math inline">\(f(n)=f(p^k)f(\frac{n}{p^k})\)</span>求出<span class="math inline">\(f(n)\)</span>。</li>
<li>令<span class="math inline">\(n=pm\)</span>，由于<span class="math inline">\(p\)</span>是<span class="math inline">\(n\)</span>的最小质因数，若<span class="math inline">\(p^2|n\)</span>，则<span class="math inline">\(p|m\)</span>，并且<span class="math inline">\(p\)</span>也是<span class="math inline">\(m\)</span>的最小质因数。这样在筛法的同时，记录每个合数最小质因数的次数，就能算出新筛去合数最小质因数的次数。</li>
<li>但是这样还不够，我们还要能够快速求解<span class="math inline">\(f(p^k)\)</span>，这时一般就要结合<span class="math inline">\(f\)</span>函数的性质来考虑。</li>
<li><p>例如欧拉函数<span class="math inline">\(\varphi\)</span>，<span class="math inline">\(\varphi(p^k)=(p-1)p^{k-1}\)</span>，因此进行筛法求<span class="math inline">\(\varphi(p*m)\)</span>时，如果<span class="math inline">\(p|m\)</span>，那么<span class="math inline">\(p*m\)</span>中<span class="math inline">\(p\)</span>的次数不为1,所以我们可以从<span class="math inline">\(m\)</span>中分解出<span class="math inline">\(p\)</span>，那么<span class="math inline">\(\varphi(p*m) = \varphi(m) * p\)</span>，否则<span class="math inline">\(\varphi(p * m) =\varphi(m) * (p-1)\)</span>。</p></li>
<li><p>再例如默比乌斯函数<span class="math inline">\(\mu\)</span>，只有当<span class="math inline">\(k=1\)</span>时<span class="math inline">\(\mu(p^k)=-1\)</span>，否则<span class="math inline">\(\mu(p^k)=0\)</span>，和欧拉函数一样根据<span class="math inline">\(m\)</span>是否被<span class="math inline">\(p\)</span>整除判断。</p></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Linear_Shaker</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">  phi[<span class="number">1</span>] = mu[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i++) &#123;</div><div class="line">    <span class="keyword">if</span> (!phi[i]) &#123;</div><div class="line">      phi[i] = i - <span class="number">1</span>;</div><div class="line">      mu[i] = <span class="number">-1</span>;</div><div class="line">      prime[cnt++] = i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt; j++) &#123;</div><div class="line">      <span class="keyword">if</span> (prime[j] * i &gt; N)</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</div><div class="line">        phi[i * prime[j]] = phi[i] * prime[j];</div><div class="line">        mu[i * prime[j]] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</div><div class="line">        mu[i * prime[j]] = -mu[i];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i++) &#123;</div><div class="line">    phi[i] += phi[i - <span class="number">1</span>];</div><div class="line">    mu[i] += mu[i - <span class="number">1</span>];</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="线性筛逆元">3.1.2.5线性筛逆元</h5>
<p>令<span class="math inline">\(f(i)\)</span>为<span class="math inline">\(i\)</span>在<span class="math inline">\(mod\ p\)</span>意义下的逆元。显然这个函数是积性函数，我们可以使用线性筛求。但是其实没有那么麻烦。</p>
<p>我们设<span class="math inline">\(p = ki+r\)</span>，那么<span class="math inline">\(ki+r \equiv 0 (mod\ p)\)</span>，两边同时乘<span class="math inline">\(i^{-1}r^{-1}\)</span>，有<span class="math inline">\(kr^{-1}+i^{-1}\equiv 0\)</span>，那么<span class="math inline">\(i^{-1} \equiv -kr^{-1}=-\lfloor \frac {p}{i} \rfloor * (p \ mod\ i)^{-1}\)</span>，这样就可以递推了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">getinv</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">  inv[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x; i++)</div><div class="line">    inv[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)(p - p/i)*inv[p % i] % p;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有了逆元，我们就可以预处理阶乘的逆元</p>
<p><span class="math display">\[n!^{-1} \equiv \prod_{k=1}^n k^{-1}\ mod \ p\]</span></p>
<h4 id="默比乌斯反演与狄利克雷卷积">3.1.3默比乌斯反演与狄利克雷卷积</h4>
<h5 id="初等积性函数mu">3.1.3.1初等积性函数<span class="math inline">\(\mu\)</span></h5>
<p><span class="math inline">\(\mu\)</span>就是容斥系数。 <span class="math display">\[
\mu(n) =
\begin{cases}
0,  &amp; \text{if $\exists x^2|n$} \\
(-1)^k&amp;n=\prod_\limits{i=1}^{k}p_i \\
\end{cases}
\]</span> <span class="math inline">\(\mu\)</span>函数也是一个积性函数。</p>
<p>下面的公式可以从容斥的角度理解。 <span class="math display">\[
\sum_{d|n}\mu(d)=[n=1]
\]</span></p>
<h5 id="默比乌斯反演">3.1.3.2默比乌斯反演</h5>
<p>首先给出Mobius反演的公式：</p>
<p><span class="math display">\[
F(n)=\sum_{d|n}f(d) \Rightarrow f(n)=\sum_{d|n}\mu(\frac{n}{d})F(d)
\]</span> 有两种常见的证明，一种是运用Dirichlet卷积，一种是使用初等方法。</p>
<p>证明： <span class="math display">\[
\sum_{d|n}\mu(d)F(\frac{n}{d}) = \sum_{d|n}\mu(\frac{n}{d})F(d)=\sum_{d|n}\mu(\frac{n}{d})\sum_{k|d}f(k)\\=\sum_{d|n}\sum_{k|d}\mu(\frac{n}{d})f(k)=\sum_{k|n}\sum_{d|\frac{n}{k}}\mu(\frac{n}{kd})f(k)\\
=\sum_{k|n}\sum_{d|\frac{n}{k}}\mu(d)f(k)=\sum_{k|n}[\frac{n}{k} = 1]f(k)=f(n)
\]</span> 默比乌斯反演的另一种形式： <span class="math display">\[
F(n)=\sum_{n|d}f(d)\Rightarrow f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)
\]</span> 这个式子的证明与上式大同小异，我在这里写一下关键步骤 <span class="math display">\[
\sum_{n|d}\sum_{d|k}\mu(\frac{d}{n})f(k)=\sum_{n|k}\sum_{d|\frac{k}{n}}\mu(d)f(k)=f(n)
\]</span> 对于一些函数<span class="math inline">\(f(n)\)</span>，如果我们很难直接求出他的值，而容易求出倍数和或者因数和<span class="math inline">\(F(n)\)</span>，那么我们可以通过默比乌斯反演来求得<span class="math inline">\(f(n)\)</span>的值</p>
<h5 id="狄利克雷卷积">3.1.3.3狄利克雷卷积</h5>
<p>定义两个数论函数<span class="math inline">\(f(x)\)</span>,<span class="math inline">\(g(x)\)</span>的<span class="math inline">\(Dirichlet\)</span>卷积 <span class="math display">\[
(f*g)(n)=\sum_{d|n}f(d)g(\frac nd)
\]</span> Dirichlet卷积满足交换律，结合律，分配律，单位元。</p>
<p>运用狄利克雷卷积不难证明默比乌斯反演。</p>
<h4 id="积性函数求和与杜教筛">3.1.4积性函数求和与杜教筛</h4>
<h5 id="概述">3.1.4.1概述</h5>
<p><strong>如果能通过狄利克雷卷积构造一个更好计算前缀和的函数，且用于卷积的另一个函数也易计算，则可以简化计算过程。</strong></p>
<p>设<span class="math inline">\(f(n)\)</span>为一个数论函数，需要计算<span class="math inline">\(S(n)=\sum_{i=1}^n f(i)\)</span>。</p>
<p>根据函数<span class="math inline">\(f(n)\)</span>的性质，构造一个<span class="math inline">\(S(n)\)</span>关于<span class="math inline">\(S(\lfloor \frac ni \rfloor)\)</span>的递推式，如下例：</p>
<p>找到一個合适的数论函数<span class="math inline">\(g(x)\)</span> <span class="math display">\[
\sum_{i=1}^n\sum_{d|i}f(d)g(\frac id)=\sum_{i=1}^ng(i)S(\lfloor\frac ni\rfloor)
\]</span> 可以得到递推式 <span class="math display">\[
g(1)S(n)=\sum_{i=1}^n(f*g)(i)-\sum_{i=2}^ng(i)S(\lfloor \frac{n}{i}\rfloor)
\]</span> 在递推计算<span class="math inline">\(S(n)\)</span>的过程中，需要被计算的<span class="math inline">\(S(\lfloor \frac ni \rfloor)\)</span>只有<span class="math inline">\(O(\sqrt n)\)</span>种。</p>
<h5 id="欧拉函数求前缀和">3.1.4.1欧拉函数求前缀和</h5>
<p>利用<span class="math inline">\(\varphi * I=id\)</span>的性质，可以有： <span class="math display">\[
S(n)=\sum_{i=1}^ni-\sum_{i=2}^nS(\lfloor \frac ni\rfloor)
\]</span></p>
<h5 id="默比乌斯函数前缀和">3.1.4.2默比乌斯函数前缀和</h5>
<p>利用<span class="math inline">\(\mu * I = e\)</span>的性质，可以有： <span class="math display">\[
S(n)=1-\sum_{i=2}^nS(\lfloor\frac ni\rfloor)
\]</span></p>
<h5 id="模板">3.1.4.3模板</h5>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function">ll <span class="title">get_p</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x &lt;= m) ? phi[x] : p[n / x]; &#125;;</div><div class="line"><span class="function">ll <span class="title">get_q</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x &lt;= m) ? mu[x] : q[n / x]; &#125;;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (x &lt;= m)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  <span class="keyword">int</span> i, last = <span class="number">1</span>, t = n / x;</div><div class="line">  <span class="keyword">if</span> (vis[t])</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  vis[t] = <span class="number">1</span>;</div><div class="line">  p[t] = ((x + <span class="number">1</span>) * x) &gt;&gt; <span class="number">1</span>;</div><div class="line">  q[t] = <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (last &lt; x) &#123;</div><div class="line">    i = last + <span class="number">1</span>;</div><div class="line">    last = x / (x / i);</div><div class="line">    solve(x / i);</div><div class="line">    p[t] -= get_p(x / i) * (last - i + <span class="number">1</span>);</div><div class="line">    q[t] -= get_q(x / i) * (last - i + <span class="number">1</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//注：本代码为了避免数组过大，p[]和q[]记录的是分母的值。</span></div></pre></td></tr></table></figure>
<h4 id="中国剩余定理">3.1.5中国剩余定理</h4>
<p>中国剩余定理给出了以下的一元线性同余方程组有解的判定条件： <span class="math display">\[
\left\{ 
\begin{array}{c}
x \equiv a_1 \pmod {m_1}\\
x \equiv a_2 \pmod {m_2}\\
\vdots \\
x \equiv a_n \pmod {m_n}
\end{array}
\right.
\]</span> 中国剩余定理指出，如果模数两两互质，那么方程组有解，并且通解可以构造得到：</p>
<ol style="list-style-type: decimal">
<li>设<span class="math inline">\(M = \prod_{i=1}^n m_i\)</span>，并设<span class="math inline">\(M_i=\frac{M}{m_i}\)</span>。</li>
<li>设<span class="math inline">\(t_i=M_i^{-1} \pmod {m_i}\)</span>。</li>
<li>那么通解<span class="math inline">\(x = \sum_{i=1}^n a_it_iM_i\)</span>。</li>
</ol>
<h4 id="高斯消元">3.1.6高斯消元</h4>
<p>Gauss消元法就是使用初等行列式变换把原矩阵转化为上三角矩阵然后回套求解。给定一个矩阵以后，我们考察每一个变量，找到它的系数最大的一行，然后根据这一行去消除其他的行。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">double</span> a[N][N]</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Gauss</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">        <span class="keyword">int</span> r=i;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++)</div><div class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(a[j][i])&gt;<span class="built_in">abs</span>(a[r][i])) r=j;</div><div class="line">        <span class="keyword">if</span>(r!=i) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n+<span class="number">1</span>;j++) swap(a[i][j],a[r][j]);</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++)&#123;</div><div class="line">            <span class="keyword">double</span> t=a[j][i]/a[i][i];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=i;k&lt;=n+<span class="number">1</span>;k++) a[j][k]-=a[i][k]*t;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=n;j&gt;i;j--) a[i][n+<span class="number">1</span>]-=a[j][n+<span class="number">1</span>]*a[i][j];</div><div class="line">        a[i][n+<span class="number">1</span>]/=a[i][i];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于xor运算，我们可以使用同样的方法消元。</p>
<p>另外，xor的话可以使用bitset压位以加速求解。</p>
<h4 id="大步小步bsgs算法">3.1.7大步小步BSGS算法</h4>
<p>大步小步算法用于解决：</p>
<p>已知<span class="math inline">\(A,B,C\)</span>，求<span class="math inline">\(x\)</span>使得, 其中<span class="math inline">\(C\ is\ a\ prime\)</span>. <span class="math display">\[
A^x\equiv B\pmod C
\]</span> 我们令<span class="math inline">\(x=i\times m-\frac{j}{m}=\lceil \sqrt C \rceil, i \in [1,m], j \in [0,m]\)</span></p>
<p>那么原式就变成了<span class="math display">\[A^{im}=A^j\times B\]</span> .我们先枚举<span class="math inline">\(j\)</span>，把<span class="math inline">\(A^j \times B\)</span>加入哈希表，然后枚举<span class="math inline">\(i\)</span>，在表中查找<span class="math inline">\(A^{im}\)</span>，如果找到了，就找到了一个解。时间复杂度为<span class="math inline">\(\Theta (\sqrt n)\)</span>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function">ll <span class="title">BSGS</span><span class="params">(ll A, ll B, ll C)</span> </span>&#123;</div><div class="line">    mp.clear();</div><div class="line">    <span class="keyword">if</span>(A % C == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-2</span>;</div><div class="line">    ll m = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(C));</div><div class="line">    ll ans;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(i == <span class="number">0</span>) &#123;</div><div class="line">            ans = B % C;</div><div class="line">            mp[ans] = i;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        ans = (ans * A) % C;</div><div class="line">        mp[ans] = i;</div><div class="line">    &#125;</div><div class="line">    ll t = <span class="built_in">pow</span>(A, m, C); </div><div class="line">    ans = t;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(i != <span class="number">1</span>)ans = ans * t % C;</div><div class="line">        <span class="keyword">if</span>(mp.count(ans)) &#123;</div><div class="line">            <span class="keyword">int</span> ret = i * m % C - mp[ans] % C;</div><div class="line">            <span class="keyword">return</span> (ret % C + C)%C;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">-2</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="组合数学">3.2组合数学</h3>
<h4 id="组合计数与二项式定理">3.2.1组合计数与二项式定理</h4>
<h5 id="二项式定理">3.2.1.1二项式定理</h5>
<p><span class="math display">\[
（a+b)^n=\sum_{i=0}^n C_n^i a^{i}b^{n-i}
\]</span></p>
<p>其中<span class="math inline">\(C_n^m\)</span>为二项式系数，满足几个结论： <span class="math display">\[
C_n^i=C_n^{n-i}
\]</span></p>
<p><span class="math display">\[
C_{n+1}^m=C_n^m+C_n^{m-1}
\]</span></p>
<p><span class="math display">\[
\sum_{i=0}^nC_n^i=2^n
\]</span></p>
<p><span class="math display">\[
C_n^k=\frac{k}{n}C_{n-1}^{k-1}
\]</span></p>
<h5 id="排列组合">3.2.1.2排列组合</h5>
<ul>
<li><p>隔板法与插空法</p></li>
<li><p>n元素集合的循环r排列的数目是<span class="math inline">\(\frac{P_n^r}r\)</span></p></li>
<li><p>多重集合全排列<span class="math display">\[\frac{n!}{\prod_i n_i!}\]</span></p></li>
<li><p>多重集合的组合，无限重复数，设S是有k种类型对象的多重集合，r组合的个数为<span class="math display">\[C_{r+k-1}^r=C_{r+k-1}^{k-1}\]</span>。</p></li>
<li><p><span class="math inline">\(Lucas\)</span>定理(p为素数) ： <span class="math display">\[
  C_n^m \equiv C_{n / p}^{m/p} \times C_{n \ mod\ p}^{m\ mod\ p} \pmod p
  \]</span></p></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> P)</span> </span>&#123; </div><div class="line">    <span class="keyword">if</span> (n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> (ll)fac[n] * inv(fac[n-m], P) % P * inv(fac[m], P)%P;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lucas</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> P)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(!n &amp;&amp; !m) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> (ll)lucas(n/P, m/P, P) * C(n%P, m%P, P) % P;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="常见数列">3.2.2常见数列</h4>
<ul>
<li>错位排列 <span class="math display">\[D_n = (n-1) * (D_{n-1} + D_{n-2})\]</span></li>
<li>Catanlan数 <span class="math display">\[C(n) = \sum (C(n-I) * C(I))\]</span> 计算公式： <span class="math display">\[C(n) = \frac{C(2n,n)}{n+1}\]</span> 应用： 满足递推关系的均可表示成catalan数，比如： 出栈顺序，二叉树种类个数，门票问题，格子问题（不穿过对角线），括号配对问题等等。</li>
</ul>
<h4 id="置换群与polya定理">3.2.3置换群与<span class="math inline">\(Polya\)</span>定理</h4>
<ul>
<li><span class="math inline">\(Burnside\)</span>引理(<span class="math inline">\(Z_k\)</span>:<span class="math inline">\(k\)</span>不动置换类,<span class="math inline">\(c_1(a)\)</span>:一阶循环的个数: <span class="math display">\[l=\frac1{|G|}\sum_{k=1}^n|Z_k|=\frac1{|G|}\sum_{j=1}^gc_1(a_j)\]</span></li>
<li>设置换群G作用于有限集合χ上，用k种颜色涂染集合χ中的元素，则χ在G作用下等价类的数目为(<span class="math inline">\(m(f)\)</span>为置换<span class="math inline">\(f\)</span>的循环节)：<span class="math display">\[N=\frac 1{|G|}\sum_{f \in G}k^{m(f)}\]</span></li>
</ul>
<h4 id="容斥原理">3.2.4容斥原理</h4>
<p><span class="math display">\[
|\cup_{i=1}^nA_i|=\sum_{i=1}^nA_i-\sum_{i,j:i\not=j}|A_i \cap A_j|+\sum_{i,j,k:i\not=j\not=k}|A_i \cap A_j \cap A_k|-\cdots \pm |A_1 \cap \cdots \cap A_n|
\]</span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; ct); i++) &#123;</div><div class="line">        <span class="comment">//do sth</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; ct; j++) &#123;</div><div class="line">            <span class="keyword">if</span>(i &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</div><div class="line">                cnt++;</div><div class="line">                <span class="comment">//do sth </span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(cnt &amp; <span class="number">1</span>) ans += tmp;</div><div class="line">        <span class="keyword">else</span> ans -= tmp;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="常见结论与技巧">3.3常见结论与技巧</h3>
<h4 id="裴蜀定理">3.3.1裴蜀定理</h4>
<p>若a,b是整数,且（a,b)=d，那么对于任意的整数x,y,ax+by都一定是d的倍数，特别地，一定存在整数x,y，使ax+by=d成立。</p>
<p>它的一个重要推论是：a,b互质的充要条件是存在整数x,y使ax+by=1.</p>
<h4 id="底和顶">3.3.2底和顶</h4>
<ul>
<li>若连续且单调增的函数<span class="math inline">\(f(x)\)</span>满足当<span class="math inline">\(f(x)\)</span>为整数时可推出<span class="math inline">\(x\)</span>为整数，则<span class="math display">\[\lfloor f(x) \rfloor = \lfloor f(\lfloor x \rfloor) \rfloor\]</span>和<span class="math inline">\(\lceil f(x) \rceil = \lceil f(\lceil x\rceil) \rceil\)</span></li>
<li><span class="math display">\[\lfloor \frac {\lfloor\frac{x}{a} \rfloor}{b}\rfloor = \lfloor \frac{x}{ab}\rfloor\]</span></li>
<li>对于<span class="math inline">\(i\)</span>，<span class="math inline">\(\lfloor \frac{n}{\lfloor \frac{n}{i}\rfloor}\rfloor\)</span>是与<span class="math inline">\(i\)</span>被<span class="math inline">\(n\)</span>除并下取整取值相同的一段区间的右端点</li>
</ul>
<h4 id="和式">3.3.3和式</h4>
<h5 id="三大定律">3.3.3.1三大定律</h5>
<ul>
<li>分配律 <span class="math display">\[\sum_{k \in K} c a_k = c \sum_{k \in K} a_k\]</span></li>
<li>结合律<span class="math display">\[\sum_{k \in K}(a_k + b_k)=\sum_{k \in K}a_k+\sum_{k \in K}b_k\]</span></li>
<li>交换律<span class="math display">\[\sum_{k \in K}a_k=\sum_{p(k) \in K} a_{p(k)}\]</span>其中p(k)是n的一个排列</li>
<li><p>松弛的交换律:若对于每一个整数<span class="math inline">\(n\)</span>，都恰好存在一个整数<span class="math inline">\(k\)</span>使得<span class="math inline">\(p(k)=n\)</span>，那么交换律同样成立。 ##### 3.3.3.2求解技巧</p></li>
<li><p>扰动法，用于计算一个和式，其思想是从一个未知的和式开始，并记他为<span class="math inline">\(S_n\)</span>：<span class="math display">\[S_n=\sum_{0 \leqslant k \leqslant n} a_k\]</span>，然后，通过将他的最后一项和第一项分离出来，用两种方法重写<span class="math inline">\(S_{n+1}\)</span>，这样我们就得到了一个关于<span class="math inline">\(S_n\)</span>的方程，就可以得到其封闭形式了。</p></li>
<li><p>一个常见的交换 <span class="math display">\[\sum_{d|n}f(d)=\sum_{d|n}f(\frac{n}{d})\]</span> ##### 3.3.3.3多重和式</p></li>
<li><p>交换求和次序：</p></li>
</ul>
<p><span class="math display">\[
\sum_j\sum_ka_{j,k}[P(j,k)]=\sum_{P(j,k)}a_{j,k}=\sum_k\sum_ja_{j,k}[P(j,k)]
\]</span></p>
<ul>
<li><p>一般分配律：<span class="math display">\[\sum_{j \in J, k \in K}a_jb_k=(\sum_{j \in J}a_j)(\sum_{k \in K}b_k)\]</span></p></li>
<li><p><span class="math inline">\(Rocky\ Road\)</span> <span class="math display">\[
  \sum_{j \in J}\sum_{k \in K(j)}a_{j,k}=\sum_{k \in K^{&#39;}}\sum_{j \in J^{&#39;}}a_{j,k}
  \]</span></p></li>
</ul>
<p><span class="math display">\[
[j \in J][k \in K(j)]=[k \in K^{&#39;}][j \in J^{&#39;}(k)]
\]</span></p>
<p>事实上，这样的因子分解总是可能的：我们可以设<span class="math inline">\(J=K^{&#39;}\)</span>是所有整数的集合，而<span class="math inline">\(K(j)\)</span>和<span class="math inline">\(J^{&#39;}(K)\)</span>是与操控二重和式的性质<span class="math inline">\(P(j,k)\)</span>相对应的集合。下面是一个特别有用的分解。</p>
<p><span class="math display">\[[1\leqslant j \leqslant n][j \leqslant k \leqslant n] = [1 \leqslant j \leqslant k \leqslant n] = [1 \leqslant k \leqslant n][1 \leqslant j \leqslant k]\]</span></p>
<ul>
<li><p>一个常见的分解 <span class="math display">\[
  \sum_{d|n}\sum_{k|d}=\sum_{k|m}\sum_{d|\frac{m}{k}}
  \]</span></p></li>
<li><p>一个技巧</p></li>
</ul>
<p>如果我们有一个包含<span class="math inline">\(k+f(j)\)</span>的二重和式，用<span class="math inline">\(k-f(j)\)</span>替换<span class="math inline">\(k\)</span>并对<span class="math inline">\(j\)</span>求和比较好。</p>
<h4 id="数论问题的求解技巧">3.3.4数论问题的求解技巧</h4>
<ul>
<li><span class="math inline">\(\{\lfloor \frac{n}{i} \rfloor|i \in [1,n]\}\)</span>只有<span class="math inline">\(O(\sqrt n)\)</span>种取值。所以可以使用这个结论降低复杂度。</li>
</ul>
<p>例如，在bzoj2301中，我们最终解出了<span class="math display">\[f(n, m)=\sum_{1 \leqslant d \leqslant min(n, m)}\mu(d)\lfloor \frac {n}{d} \rfloor \lfloor \frac {m}{d} \rfloor\]</span>我们就可以使用杜教筛计算出默比乌斯函数的前缀和，计算出商与除以i相同的最多延伸到哪里，下一次直接跳过这一段就好了。下面是这个题的一段程序。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>, last;</div><div class="line">    <span class="keyword">if</span>(n &gt; m) <span class="built_in">std</span>::swap(n, m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i = last + <span class="number">1</span>) &#123; <span class="comment">//i就相当于原式中的d</span></div><div class="line">        last = min(n / (n/i), m / (m/i));  <span class="comment">//last计算了商与除以i相同的最多延伸到哪里，不难证明这样计算的正确性</span></div><div class="line">        ret += (n / i) * (m / i) * (sum[last] - sum[i<span class="number">-1</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="一些可能会用到的定理">3.3.5一些可能会用到的定理</h4>
<h5 id="费马小定理">3.3.5.1费马小定理</h5>
<p><span class="math display">\[
a^{p-1}\equiv1\pmod p
\]</span></p>
<p>条件：<span class="math inline">\(p\ is\ prime\ and\ (a,p)=1\)</span></p>
<h5 id="欧拉定理">3.3.5.2欧拉定理</h5>
<p><span class="math display">\[
a^{\varphi(p)}\equiv 1\pmod p
\]</span></p>
<p>条件：<span class="math inline">\(a,p \in \mathbb{Z^+}, (a, p)=1\)</span></p>
<h5 id="威尔逊定理">3.3.5.3威尔逊定理</h5>
<p><span class="math display">\[
(p-1)!\equiv-1\pmod p \Leftrightarrow p\ is\ prime
\]</span></p>
<h5 id="皮克定理">3.3.5.4皮克定理</h5>
<p><span class="math display">\[
S=n+\frac s2-1
\]</span></p>
<p>(其中<span class="math inline">\(n\)</span>表示多边形内部的点数,<span class="math inline">\(s\)</span>表示多边形边界上的点数,<span class="math inline">\(S\)</span>表示多边形的面积)</p>
<h3 id="其他数学工具">3.4其他数学工具</h3>
<h4 id="快速乘">3.4.1快速乘</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll a, ll b)</span> </span>&#123;</div><div class="line">  ll x = <span class="number">0</span>;</div><div class="line">  <span class="keyword">while</span> (b) &#123;</div><div class="line">    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</div><div class="line">      x = (x + a) % p;</div><div class="line">    a = (a &lt;&lt; <span class="number">1</span>) % p;</div><div class="line">    b &gt;&gt;= <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> x;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="快速幂">3.4.2快速幂</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">pow</span><span class="params">(ll a, ll b, ll p)</span> </span>&#123;</div><div class="line">  ll x = <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (b) &#123;</div><div class="line">    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</div><div class="line">      x = mul(x, a);</div><div class="line">    a = mul(a, a);</div><div class="line">    b &gt;&gt;= <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> x;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="更相减损术">3.4.3更相减损术</h4>
<p>第一步：任意给定两个正整数；判断它们是否都是偶数。若是，则用2约简；若不是则执行第二步。</p>
<p>第二步：以较大的数减较小的数，接着把所得的差与较小的数比较，并以大数减小数。继续这个操作，直到所得的减数和差相等为止。</p>
<p>则第一步中约掉的若干个2与第二步中等数的乘积就是所求的最大公约数。</p>
<h4 id="逆元">3.4.4逆元</h4>
<p>根据费马小定理(p是质数)，</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> P)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">pow</span>(x, P<span class="number">-2</span>, P);&#125;</div></pre></td></tr></table></figure>
<p>或使用扩展欧几里德:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> P)</span> </span>&#123;</div><div class="line">  <span class="keyword">int</span> d, a, b;</div><div class="line">  gcd(x, P, d, a, b);</div><div class="line">  <span class="keyword">return</span> d == <span class="number">1</span> ? (a+P)%P : <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="博弈论">3.4.5博弈论</h4>
<ul>
<li>Nim游戏</li>
<li>SG函数</li>
</ul>
<p>定义<span class="math display">\[SG(x)=mex(S)\]</span>，其中<span class="math inline">\(S\)</span>是<span class="math inline">\(x\)</span>的后继状态的<span class="math inline">\(SG\)</span>函数集合，<span class="math inline">\(mex(S)\)</span>表示<strong>不在</strong><span class="math inline">\(S\)</span>内的最小非负整数。</p>
<ul>
<li>SG定理</li>
</ul>
<p>组合游戏和的<span class="math inline">\(SG\)</span>函数等于各子游戏<span class="math inline">\(SG\)</span>函数的<span class="math inline">\(Nim\)</span>和。</p>
<h4 id="概率与数学期望">3.4.6概率与数学期望</h4>
<ul>
<li>全概率公式<span class="math display">\[P(A)=P(A|B_1)*P(B_1)+P(A|B_2)*P(B_2)+\cdots+P(A|B_n)*P(B_n)\]</span></li>
<li>数学期望</li>
</ul>
<h4 id="快速傅立叶变换">3.4.7快速傅立叶变换</h4>
<h5 id="基本定义">3.4.7.1基本定义</h5>
<p>快速傅立叶变换(FFT)用于求解多项式的卷积.</p>
<ul>
<li>单位根:单位圆的<span class="math inline">\(n\)</span>等分点为终点,作<span class="math inline">\(n\)</span>个向量,所得的幅角为正且最小的向量对应的复数为<span class="math inline">\(\omega_n\)</span>,称为<span class="math inline">\(n\)</span>次单位根. <span class="math display">\[\omega_n^k=cosk\frac{2\pi}{n}+isin\ k\frac{2\pi}n\]</span></li>
<li>单位根的性质:<span class="math display">\[\omega_{2n}^{2k}=\omega_n^k\]</span></li>
<li>单位根的性质:<span class="math display">\[\omega_{n}^{k+\frac nk}=-\omega _n^k\]</span></li>
</ul>
<h5 id="快速傅立叶变换-1">3.4.7.2快速傅立叶变换</h5>
<p>考虑将多项式<span class="math inline">\(A_1(x)=a_0+a_2x^2+a_4x^4+\cdots+a_{n-2}x^{\frac n2 -1}\)</span></p>
<p><span class="math display">\[A_2(x)=a_1+a_3x+a_5x^2+\cdots+a_{n-1}x^{\frac n2 -1}\]</span></p>
<p>则有<span class="math display">\[A(x)=A_1(x)+xA_2(x)\]</span></p>
<p>有<span class="math display">\[A(\omega_n^k)=A_1(\omega_n^{2k})+\omega_n^kA_2(\omega_n^{2k})\]</span></p>
<p>有<span class="math display">\[A(\omega_n^{k+\frac n2})=A_1{\omega_\frac n2^k-\omega_n^kA_2(\omega_\frac n2 ^ k)}\]</span>.</p>
<p>注意到,当<span class="math inline">\(k\)</span>取遍<span class="math inline">\([0,\frac n2 -1]\)</span>时,<span class="math inline">\(k\)</span>和<span class="math inline">\(k+\frac n2\)</span>取遍了<span class="math inline">\([0,n-1]\)</span>,也就是说，如果已知<span class="math inline">\(A_1(x)\)</span>和<span class="math inline">\(A_2(x)\)</span>在<span class="math inline">\(\omega_{n/2}^0,\omega_{n/2}^1,\cdots,\omega_{n/2}^{n/2-1}\)</span>处的点值，就可以在<span class="math inline">\(O(n)\)</span>的时间内求得<span class="math inline">\(A(x)\)</span>在<span class="math inline">\(\omega_n^0,\omega_n^1,\cdots,\omega_n^{n-1}\)</span>处的取值。而关于 <span class="math inline">\(A_1(x)\)</span> 和 <span class="math inline">\(A_2(x)\)</span> 的问题都是相对于原问题规模缩小了一半的子问题，分治的边界为一个常数项<span class="math inline">\(a_0\)</span>.</p>
<p>该算法的复杂度为<span class="math inline">\(O(nlogn)\)</span>.</p>
<h5 id="傅立叶逆变换">3.4.7.3傅立叶逆变换</h5>
<p>设<span class="math inline">\((y_0,y_1,\cdots,y_{n-1})\)</span>为<span class="math inline">\((a_0,\cdots,a_{n-1})\)</span>的快速傅立叶变换. 考虑另一个向量<span class="math inline">\((c_0,\cdots,c_{n-1})\)</span>满足</p>
<p><span class="math display">\[c_k=\sum_{i=0}^{n-1}y_i(\omega_n^{-k})^i\]</span>.</p>
<p>即多项式<span class="math inline">\(B(x)=y_0+y_1x+\cdots+y_{n-1}x^{n-1}\)</span>在<span class="math inline">\(\omega_n^0,\cdots,\omega_n^{-(n-1)}\)</span>处的点值表示.</p>
<p>可以得到(证明略)</p>
<p><span class="math display">\[a_i=\frac 1n c_i\]</span>.</p>
<p>所以，使用单位根的倒数代替单位根，做一次类似快速傅里叶变换的过程，再将结果每个数除以<span class="math inline">\(n\)</span>，即为傅里叶逆变换的结果。</p>
<h5 id="代码实现">3.7.4.4代码实现</h5>
<p>FFT有两种常见的代码实现: 递归版本和迭代版本,一般来讲递归效率很差,但由于我非常菜,一轮省选就先使用递归版本骗分.迭代版本以后会更新.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</div><div class="line"><span class="keyword">bool</span> inversed = <span class="literal">false</span>;</div><div class="line"><span class="keyword">inline</span> <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; omega(<span class="keyword">const</span> <span class="keyword">int</span> n, <span class="keyword">const</span> <span class="keyword">int</span> k) &#123;</div><div class="line">  <span class="keyword">if</span> (!inversed)</div><div class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt;(<span class="built_in">cos</span>(<span class="number">2</span> * PI / n * k), <span class="built_in">sin</span>(<span class="number">2</span> * PI / n * k));</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::conj(</div><div class="line">        <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt;(<span class="built_in">cos</span>(<span class="number">2</span> * PI / n * k), <span class="built_in">sin</span>(<span class="number">2</span> * PI / n * k)));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; *a, <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; *ans, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</div><div class="line">    ans[<span class="number">0</span>] = a[<span class="number">0</span>];</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; buf[maxn];</div><div class="line">  <span class="keyword">int</span> m = n &gt;&gt; <span class="number">1</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">    buf[i] = a[i * <span class="number">2</span>];</div><div class="line">    buf[i + m] = a[i * <span class="number">2</span> + <span class="number">1</span>];</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; tmp[maxn];</div><div class="line">  fft(buf, tmp, m);</div><div class="line">  fft(buf + m, tmp + m, m);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">    <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; x = omega(n, i);</div><div class="line">    ans[i] = tmp[i] + x * tmp[i + m];</div><div class="line">    ans[i + m] = tmp[i] - x * tmp[i + m];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">//sth</span></div><div class="line">  <span class="keyword">while</span> (N &lt; n + <span class="number">1</span>)</div><div class="line">    N &lt;&lt;= <span class="number">1</span>;</div><div class="line">  N &lt;&lt;= <span class="number">1</span>;</div><div class="line">  fft(a, ans1, N);</div><div class="line">  fft(b, ans2, N);</div><div class="line">  <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; ans3[maxn];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">    ans3[i] = ans1[i] * ans2[i];</div><div class="line">  <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; tmp[maxn];</div><div class="line">  inversed = <span class="literal">true</span>;</div><div class="line">  fft(ans3, tmp, N);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">    c[i] = tmp[i].real() / N;</div><div class="line">  <span class="comment">//sth</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>$©  $</p>

    
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yNzk0Ni80NTIz"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars2.githubusercontent.com/u/8966584?v=3&s=460"
               alt="Geng Chen" />
          <p class="site-author-name" itemprop="name">Geng Chen</p>
           
              <p class="site-description motion-element" itemprop="description">problems, notes and solutions</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">175</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">95</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/MrMorning" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/geng-chen-51/activities" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-wheelchair"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2-SAT/">2-SAT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AC自动机/">AC自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BSGS/">BSGS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDQ分治/">CDQ分治</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFT/">FFT</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMP/">KMP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Manacher/">Manacher</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTT/">NTT</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Polya定理/">Polya定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Prufer编码/">Prufer编码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/">STL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trie/">Trie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dfs序列/">dfs序列</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lca/">lca</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lct/">lct</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spfa/">spfa</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/splay/">splay</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/上下界网络流/">上下界网络流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/主席树/">主席树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/乱搞/">乱搞</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二分/">二分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二分图/">二分图</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代价提前计算/">代价提前计算</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/倍增/">倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/凸包/">凸包</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分块/">分块</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分层图/">分层图</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分数规划/">分数规划</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态点分治/">动态点分治</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态规划/">动态规划</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单调栈/">单调栈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博弈论/">博弈论</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原根/">原根</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后缀数组/">后缀数组</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后缀自动机/">后缀自动机</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图论/">图论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多项式/">多项式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/好题/">好题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字典序/">字典序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串/">字符串</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串哈希/">字符串哈希</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习笔记/">学习笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/容斥原理/">容斥原理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/平面图/">平面图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并查集/">并查集</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/广义后缀自动机/">广义后缀自动机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/强连通分量/">强连通分量</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/拆点/">拆点</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/括号序列/">括号序列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搜索/">搜索</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/摸鱼/">摸鱼</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数位DP/">数位DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学知识/">数学知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a><span class="tag-list-count">37</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数论/">数论</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/斜率优化/">斜率优化</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最大流/">最大流</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最小割/">最小割</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/权值线段树/">权值线段树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/李超线段树/">李超线段树</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/枚举/">枚举</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树上倍增/">树上倍增</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树套树/">树套树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树形DP/">树形DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树形dp/">树形dp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树状数组/">树状数组</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树链剖分/">树链剖分</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模型转化/">模型转化</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板/">模板</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/欧拉函数/">欧拉函数</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/点分治/">点分治</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/特殊数列/">特殊数列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/状压DP/">状压DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生成函数/">生成函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生成树/">生成树</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生成树计数/">生成树计数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/矩阵乘法/">矩阵乘法</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/矩阵树定理/">矩阵树定理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/离散对数/">离散对数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/离线处理/">离线处理</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线性规划/">线性规划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线段树/">线段树</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/组合数学/">组合数学</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/结论题/">结论题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络流/">网络流</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/莫队算法/">莫队算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/蒟蒻/">蒟蒻</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/负环/">负环</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪心/">贪心</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/费用流/">费用流</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/退流/">退流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/递归/">递归</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高斯消元/">高斯消元</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高精度/">高精度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/默比乌斯反演/">默比乌斯反演</a><span class="tag-list-count">2</span></li></ul>
        </canvas>
    </div>
</div>


        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              无限ym的神犇们Orz
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/candy99" title="Candy?" target="_blank">Candy?</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://worldframe.top" title="冯硕" target="_blank">冯硕</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/orzgeotcbrl" title="orzGEOTCBRL" target="_blank">orzGEOTCBRL</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/lidaxin" title="hahalidaxin" target="_blank">hahalidaxin</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/y-clever/" title="SDOI最强-IOI AK爷-rqy" target="_blank">SDOI最强-IOI AK爷-rqy</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://sforest.in/" title="约修亚_RK" target="_blank">约修亚_RK</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://mby.pw/" title="mby" target="_blank">mby</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/huibixiaoxing/" title="嘒彼小星" target="_blank">嘒彼小星</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/zhenghaotian" title="zht" target="_blank">zht</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      
          </div>
  </aside>



        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Geng Chen</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

</body>
</html>
